{"ast":null,"code":"import _slicedToArray from \"/home/user/Documents/frontend-preyana/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/user/Documents/frontend-preyana/src/components/booking/booking-grid.js\";\nimport React from 'react';\nimport './booking-grid.css';\nimport { useLocation } from 'react-router-dom';\nimport { FC, Fragment, useState } from 'react';\nconst MyComponent = props => {\n  const _useState = useState(false),\n    _useState2 = _slicedToArray(_useState, 2),\n    isFetching = _useState2[0],\n    setIsFetching = _useState2[1];\n  console.log(\"props\");\n  console.log(props);\n  const location = useLocation();\n  console.log(\"location.state.contactDetails\");\n  console.log(location.state.contactDetails);\n  let arr = [];\n  let passengers = [];\n  arr = location.state.contactDetails;\n  arr.map((item, index) => {\n    let familyname1 = \"familyname\" + index;\n    let given_name1 = \"given_name\" + index;\n    let email1 = \"email\" + index;\n    passengers.push({\n      phone_number: \"+\" + location.state.contactDetails[index].phone,\n      email: location.state.contactDetails[index].email,\n      given_name: location.state.contactDetails[index].givenName,\n      family_name: location.state.contactDetails[index].familyname,\n      gender: location.state.contactDetails[index].gender == 'Female' ? 'F' : 'M',\n      title: location.state.contactDetails[index].title,\n      born_on: location.state.contactDetails[index].dateOfBirth,\n      id: location.state.contactDetails[index].passenger_id\n    });\n    if (location.state.contactDetails[index].type === 'infant_without_seat') {\n      passengers[0].infant_passenger_id = location.state.contactDetails[index].passenger_id;\n    }\n  });\n  console.log(\"passengers\" + JSON.stringify(passengers));\n  console.log(\"jwtKey\" + props.flights[0]);\n  const flights = props.flights || {};\n  flights.nonStopFlights = props.flights;\n  const flightsCount = flights.length;\n  const duffelAncillariesElement = document.querySelector(\"duffel-ancillaries\");\n  duffelAncillariesElement.render({\n    offer_id: location.state.contactDetails[0].offer_id,\n    client_key: props.flights[0],\n    services: [\"bags\", \"seats\"],\n    passengers: passengers\n  });\n  var test;\n  // 4. Listen to 'onPayloadReady' event on the component. `event.detail.data` contains the payload you need to send to Duffel's API to create an order.\n  duffelAncillariesElement.addEventListener(\"onPayloadReady\", event => {\n    let final_amountdata = Number.parseFloat(event.detail.data.payments[0].amount).toFixed(2);\n    event.detail.data.payments[0].amount = final_amountdata;\n    let body = JSON.stringify({\n      data: event.detail.data\n    });\n    console.log(\"body\");\n    console.log(body);\n    let amountdata = Number.parseFloat(event.detail.data.payments[0].amount).toFixed(2);\n    console.log(amountdata);\n    const requestOptions = {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: body\n    };\n    test = body;\n  });\n  const duffelpaymentsElement = document.querySelector(\"duffel-payments\");\n\n  // 3. Render the component with the required data, you can safely call this function as many times as you want.\n  duffelpaymentsElement.render({\n    paymentIntentClientToken: 'eyJjbGllbnRfc2VjcmV0IjoicGlfMUl5YTBiQW5rMVRkeXJvRE1iWkJPN0ZSX3NlY3JldF9TbGFrYnJjYnFHZGZha2VrcjdCNE5jZWVyIiwicHVibGlzaGFibGVfa2V5IjoicGtfbGl2ZV81MUl0Q3YwQW5rMUdkeXJvRFlFU3M3RnBTUEdrNG9kbDhneDF3Y1RBNVEzaUcyWEFWVEhxdFlKSVhWMUxoSU5GQUtFMjA1dFdmRGVIcXhwUVdnYkIzTkVFbzAwMmdVY1hzR0YifQ==',\n    debug: false,\n    live_mode: true\n  });\n\n  // 4. Listen to 'onSuccessfulPayment' event on the component:\n  duffelpaymentsElement.addEventListener(\"onSuccessfulPayment\", () => console.log(\"onPayloadReady\\n\"));\n\n  // 5. If we run into an issue with the payment, you can listen to 'onFailedPayment' event:\n  duffelpaymentsElement.addEventListener(\"onFailedPayment\", event => console.log(\"onPayloadReady\\n\", event.detail));\n  const bookOffer = async () => {\n    console.log(\"fsddddddddddddddd\");\n    setIsFetching(true);\n    console.log(\"location\");\n    console.log(location);\n    const amount = props.flights[1][0].base_amount;\n    const currency = props.flights[1][0].base_currency;\n    const type = 'balance';\n    const payments = {\n      type: type,\n      amount: amount,\n      currency: currency\n    };\n    test = {\n      \"type\": \"hold\",\n      \"selected_offers\": [location.state.contactDetails[0].offer_id],\n      \"passengers\": passengers,\n      \"payments\": payments\n    };\n    console.log(\"test\");\n    console.log(test);\n    const _await$await$fetch$js = await (await fetch('http://localhost:3000/airlines/book', {\n        method: 'post',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(test)\n      })).json(),\n      data = _await$await$fetch$js.data,\n      errors = _await$await$fetch$js.errors;\n    if (data) {\n      console.log(data);\n    } else {\n      // TODO: handle the errors properly\n      console.info(errors);\n    }\n    setIsFetching(false);\n  };\n  return /*#__PURE__*/React.createElement(\"button\", {\n    disabled: isFetching,\n    onClick: async () => await bookOffer(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 7\n    }\n  }, isFetching ? 'Bookingâ€¦' : 'Book');\n};\nexport default MyComponent;","map":{"version":3,"names":["React","useLocation","FC","Fragment","useState","MyComponent","props","_useState","_useState2","_slicedToArray","isFetching","setIsFetching","console","log","location","state","contactDetails","arr","passengers","map","item","index","familyname1","given_name1","email1","push","phone_number","phone","email","given_name","givenName","family_name","familyname","gender","title","born_on","dateOfBirth","id","passenger_id","type","infant_passenger_id","JSON","stringify","flights","nonStopFlights","flightsCount","length","duffelAncillariesElement","document","querySelector","render","offer_id","client_key","services","test","addEventListener","event","final_amountdata","Number","parseFloat","detail","data","payments","amount","toFixed","body","amountdata","requestOptions","method","headers","duffelpaymentsElement","paymentIntentClientToken","debug","live_mode","bookOffer","base_amount","currency","base_currency","_await$await$fetch$js","fetch","json","errors","info","createElement","disabled","onClick","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber"],"sources":["/home/user/Documents/frontend-preyana/src/components/booking/booking-grid.js"],"sourcesContent":["import React from 'react';\nimport './booking-grid.css';\nimport { useLocation } from 'react-router-dom';\nimport { FC, Fragment, useState } from 'react'\n\n\n  const MyComponent = (props) => {\n  const [isFetching, setIsFetching] = useState(false)\n\n  console.log(\"props\");\n  console.log(props);\n\n\n  const location = useLocation();\n  console.log(\"location.state.contactDetails\");\n  console.log(location.state.contactDetails);\n  let arr=[];\n  let passengers =[];\n  arr=location.state.contactDetails;\n\n  arr.map((item, index) => {\n    let familyname1 =\"familyname\"+index;\n    let given_name1 =\"given_name\"+index;\n    let email1 =\"email\"+index;\n    passengers.push({\n        phone_number: \"+\" + location.state.contactDetails[index].phone,\n        email: location.state.contactDetails[index].email,\n        given_name: location.state.contactDetails[index].givenName,\n        family_name: location.state.contactDetails[index].familyname,\n        gender: location.state.contactDetails[index].gender == 'Female' ? 'F' : 'M',\n        title: location.state.contactDetails[index].title,\n        born_on: location.state.contactDetails[index].dateOfBirth,\n        id: location.state.contactDetails[index].passenger_id,\n\n    })\n    if(location.state.contactDetails[index].type === 'infant_without_seat'){\n      passengers[0].infant_passenger_id = location.state.contactDetails[index].passenger_id;\n    }\n  })\n\n\n  console.log(\"passengers\"+JSON.stringify(passengers));\n  console.log(\"jwtKey\"+props.flights[0]);\n  const flights = props.flights || {};\n  flights.nonStopFlights = props.flights;\n  const flightsCount = (flights.length);\n  const duffelAncillariesElement = document.querySelector(\n    \"duffel-ancillaries\"\n  );\n\n  duffelAncillariesElement.render({    \n    offer_id: location.state.contactDetails[0].offer_id,\n    client_key: props.flights[0],\n    services: [\"bags\", \"seats\"],\n    passengers:passengers,\n  \n    \n  });\n  var test;\n  // 4. Listen to 'onPayloadReady' event on the component. `event.detail.data` contains the payload you need to send to Duffel's API to create an order.\n  duffelAncillariesElement.addEventListener(\"onPayloadReady\", (event) => {\n\n    let final_amountdata = Number.parseFloat(event.detail.data.payments[0].amount).toFixed(2);\n    event.detail.data.payments[0].amount = final_amountdata;\n    let body = JSON.stringify({ data: event.detail.data });\n    console.log(\"body\");\n    console.log(body);\n\n    let amountdata = Number.parseFloat(event.detail.data.payments[0].amount).toFixed(2);\n    console.log(amountdata);\n    const requestOptions = {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: body\n    };\n    test = body;\n  });\n  \n    const duffelpaymentsElement = document.querySelector(\"duffel-payments\");\n\n    // 3. Render the component with the required data, you can safely call this function as many times as you want.\n    duffelpaymentsElement.render({\n      paymentIntentClientToken:'eyJjbGllbnRfc2VjcmV0IjoicGlfMUl5YTBiQW5rMVRkeXJvRE1iWkJPN0ZSX3NlY3JldF9TbGFrYnJjYnFHZGZha2VrcjdCNE5jZWVyIiwicHVibGlzaGFibGVfa2V5IjoicGtfbGl2ZV81MUl0Q3YwQW5rMUdkeXJvRFlFU3M3RnBTUEdrNG9kbDhneDF3Y1RBNVEzaUcyWEFWVEhxdFlKSVhWMUxoSU5GQUtFMjA1dFdmRGVIcXhwUVdnYkIzTkVFbzAwMmdVY1hzR0YifQ==',\n      debug: false,\n      live_mode : true\n    });\n\n    // 4. Listen to 'onSuccessfulPayment' event on the component:\n    duffelpaymentsElement.addEventListener(\"onSuccessfulPayment\", () =>\n      console.log(\"onPayloadReady\\n\")\n    );\n\n    // 5. If we run into an issue with the payment, you can listen to 'onFailedPayment' event:\n    duffelpaymentsElement.addEventListener(\"onFailedPayment\", (event) =>\n      console.log(\"onPayloadReady\\n\", event.detail)\n    );\n\n    const bookOffer = async () => {\n      console.log(\"fsddddddddddddddd\");\n      setIsFetching(true)\n\n\n      console.log(\"location\");\n      console.log(location);\n\n     const amount = props.flights[1][0].base_amount;\n     const currency = props.flights[1][0].base_currency;\n     const type = 'balance';\n\n     const payments ={type:type,amount:amount,currency:currency};\n\n      test = {\n          \"type\": \"hold\",\n          \"selected_offers\": [location.state.contactDetails[0].offer_id],\n          \"passengers\":passengers,\n          \"payments\":payments\n              }\n\n              console.log(\"test\");\n              console.log(test);\n\n      const { data, errors } = await (\n        await fetch('http://localhost:3000/airlines/book', {\n          method: 'post',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify(test)\n        })\n      ).json()\n\n      if (data) {\n        console.log(data)\n      } else {\n        // TODO: handle the errors properly\n        console.info(errors)\n      }\n      setIsFetching(false)\n    }\n    return (\n \n\n      <button disabled={isFetching}\n        onClick={async () => await bookOffer()}\n      >{isFetching ? 'Bookingâ€¦' : 'Book'}</button>\n\n\n  )\n\n  }\n\n\n\n\nexport default MyComponent\n\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}